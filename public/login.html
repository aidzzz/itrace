<!--
=========================================================
ITRACE APP
=========================================================
Coded by Adrian Neil Asence
=========================================================
The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  
  <link rel="icon" type="image/png" href="assets/img/icons/icon-72x72.png">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>
    ITRACE
  </title>
  <meta content='width=device-width, initial-scale=1.0, shrink-to-fit=no' name='viewport' />
  <meta content='yes' name='apple-mobile-web-app-capable'/>
  <meta content='yes' name='mobile-web-app-capable'/>
  <!--     Fonts and icons     -->
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
  <!-- CSS Files -->
  <link href="assets/css/material-dashboard.css?v=2.1.2" rel="stylesheet" />
  <!-- CSS Just for demo purpose, don't include it in your project -->
  <link href="assets/css/main.css" rel="stylesheet" />
  
  <link rel="manifest" href="manifest.json">

  <!-- ios support -->
  <link rel="apple-touch-icon" sizes="76x76" href="assets/img/icons/icon-96x96.png">
  <meta name="apple-mobile-web-app-status-bar" content="#6c0e7f">
  <meta name="theme-color" content="#9c27b0">

</head>

<body class="" oncontextmenu="return false">
  <div class="wrapper ">
  
    <div class="main-panel">
      <!-- Navbar -->

      <!-- End Navbar -->
      <div class="content">
        <div class="container-fluid">
          <div class="card col-lg-9">
            <div class="card-header card-header-primary">
              <h3 class="card-title">ITRACE APP</h3>
              <span class="card-category">Select if viewer or tracer <i class="material-icons" onclick="swalfire('login_info')">info_outline</i></span>
            </div>
            <div class="card-body">
              <div class="row" id="option_panel">                
                <div class="col-sm-12 mb-3 mt-2">
                  <button onclick="window.location.href = 'viewer/dashboard.html' ;" class="btn btn-lg btn-success btn-block mt-3 mb-3">Viewer</button>
                </div>
                <p class="mx-auto h5" >OR</p>
                <div class="col-sm-12">
                  <button  id="tracer_login_btn"  class="btn btn-lg btn-warning btn-block mt-3 mb-3">Tracer</button>
                </div>
              </div>

              <div id="tracer_login" class="d-none">
                <form id="login_form" autocomplete="off"> 
                  <div class="row">
                    <div class="col-sm-12 mb-2 mt-2">
                      <div class="form-group">
                        <label class="bmd-label-floating">Username</label>
                        <input type="text" class="form-control" id="username" autocomplete="off">
                      </div>
                    </div>
                    <div class="col-sm-12 mb-2 mt-2">
                      <div class="form-group">
                        <label class="bmd-label-floating">Password</label>
                        <input type="password" class="form-control" id="password">
                      </div>
                    </div>
                  </div>
                  
                  <button id="login_btn" type="submit" class="btn btn-primary btn-block mt-3 mb-3">Login</button>
                  <div class="text-center">
                    <a href="javascript:void(0);" id="return_to_options">Back to selection</a>
                  </div>
                  <div class="clearfix"></div>                  
                </form>
              </div>
              
            </div>
          </div>
        </div>
      </div>
      
    </div>
  </div>
 
    
  
  <!--   Core JS Files   -->
  <script src="assets/js/core/jquery.min.js"></script>
  <script src="assets/js/core/popper.min.js"></script>
  <script src="assets/js/core/bootstrap-material-design.min.js"></script>
  <script src="assets/js/plugins/perfect-scrollbar.jquery.min.js"></script>
  <!-- Plugin for the momentJs  -->
  <script src="assets/js/plugins/moment.min.js"></script>
  <!--  Plugin for Sweet Alert -->
  <script src="assets/js/plugins/sweetalert2.js"></script>
  <!-- Forms Validations Plugin -->
  <script src="assets/js/plugins/jquery.validate.min.js"></script>
  <!-- Plugin for the Wizard, full documentation here: https://github.com/VinceG/twitter-bootstrap-wizard -->
  <script src="assets/js/plugins/jquery.bootstrap-wizard.js"></script>
  <!--	Plugin for Select, full documentation here: http://silviomoreto.github.io/bootstrap-select -->
  <script src="assets/js/plugins/bootstrap-selectpicker.js"></script>
  <!--  Plugin for the DateTimePicker, full documentation here: https://eonasdan.github.io/bootstrap-datetimepicker/ -->
  <script src="assets/js/plugins/bootstrap-datetimepicker.min.js"></script>
  <!--  DataTables.net Plugin, full documentation here: https://datatables.net/  -->
  <script src="assets/js/plugins/jquery.dataTables.min.js"></script>
  <!--	Plugin for Tags, full documentation here: https://github.com/bootstrap-tagsinput/bootstrap-tagsinputs  -->
  <script src="assets/js/plugins/bootstrap-tagsinput.js"></script>
  <!-- Plugin for Fileupload, full documentation here: http://www.jasny.net/bootstrap/javascript/#fileinput -->
  <script src="assets/js/plugins/jasny-bootstrap.min.js"></script>
  <!--  Full Calendar Plugin, full documentation here: https://github.com/fullcalendar/fullcalendar    -->
  <script src="assets/js/plugins/fullcalendar.min.js"></script>
  <!-- Vector Map plugin, full documentation here: http://jvectormap.com/documentation/ -->
  <script src="assets/js/plugins/jquery-jvectormap.js"></script>
  <!--  Plugin for the Sliders, full documentation here: http://refreshless.com/nouislider/ -->
  <script src="assets/js/plugins/nouislider.min.js"></script>
  <!-- Include a polyfill for ES6 Promises (optional) for IE11, UC Browser and Android browser support SweetAlert -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/core-js/2.4.1/core.js"></script>
  <!-- Library for adding dinamically elements -->
  <script src="assets/js/plugins/arrive.min.js"></script>
  <!--  Google Maps Plugin    -->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCL0GSMCN9vKb6AUulcxHsLEj3JQHVJS9M"></script>
  <!-- Chartist JS -->
  <script src="assets/js/plugins/chartist.min.js"></script>
  <!--  Notifications Plugin    -->
  <script src="assets/js/plugins/bootstrap-notify.js"></script>
  <!-- Control Center for Material Dashboard: parallax effects, scripts for the example pages etc -->
  <script src="assets/js/material-dashboard.js?v=2.1.2" type="text/javascript"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jsSHA/2.0.2/sha.js"></script>
  <!--  -->
  <script src="https://www.gstatic.com/firebasejs/8.4.3/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.4.3/firebase-firestore.js"></script>
  <script src="assets/js/main.js"></script>
  <!-- <script src="assets/js/app.js"></script> -->
  <script src="assets/js/swalfire.js"></script>
  <script src="assets/js/fstore.js"></script>
  <script src="assets/js/session.js"></script>
  
  <script>


      $(document).ready(function(){

        if('serviceWorker' in navigator){
            navigator.serviceWorker.register('sw.js')
            .then( (register) => console.log('Service Worker registered', register))
            .catch( (error) => console.log('Service Worker not registered' , error));
        }
        
      })

      $('#tracer_login_btn').click(function(){
        if($('#option_panel').hasClass("d-none") == false){          
          $('#tracer_login').removeClass("d-none")
          $('#option_panel').addClass("d-none")
        }        
      });

      $('#return_to_options').click(function(){
        if($('#tracer_login').hasClass("d-none") == false){          
          $('#option_panel').removeClass("d-none")
          $('#tracer_login').addClass("d-none")
        }        
      });
     

      const login_form = document.querySelector('#login_form');
      const login_btb = document.querySelector('#login_btn');


      function passwordhash(password) {
        const hash_password = new jsSHA("SHA-256", "TEXT", {numRounds: 1});
        hash_password.update(password);
        const hashed = hash_password.getHash("HEX");
        return hashed;
      }
      login_form.addEventListener('submit', event =>{
        event.preventDefault();
        
        const login_data ={
          username: login_form.username.value,
          password: passwordhash(login_form.password.value) 
        }


        if(login_data.username == '' || login_data.password == ''){
          swalfire('login_empty');
        }else{
          
          session.authSession(login_data)

        }
      
      });
      

      
  </script>
</body>
  
</html>